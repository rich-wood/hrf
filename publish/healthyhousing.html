<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HUNTER INSIGHTS DASHBOARD - HOUSING INSIGHT SERIES</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">HUNTER INSIGHTS DASHBOARD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./healthyhousing.html" rel="" target="" aria-current="page">
 <span class="menu-text">HOUSING INSIGHTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./GeogOfJobs.html" rel="" target="">
 <span class="menu-text">GEOGRAPHY OF JOBS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EconUpdate.html" rel="" target="">
 <span class="menu-text">ECONOMIC UPDATE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./long_term.html" rel="" target="">
 <span class="menu-text">STRUCTURAL CHANGE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./housing.html" rel="" target="">
 <span class="menu-text">HOUSING DASHBOARD</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./multipliers.html" rel="" target="">
 <span class="menu-text">MULTIPLIERS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./emissions.html" rel="" target="">
 <span class="menu-text">Emissions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">HOUSING INSIGHT SERIES</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="slides_housing/slide1.png" class="img-fluid"></p>
<div class="container">
<p>Delivering more affordable, quality housing is one of Australia’s most wicked problems, and industry and governments at all levels are committing significant resources to address chronic shortages.</p>
<p>In this presentation, the Institute of Regional Future’s Director of Research Programs, Amanda Wetzel, provides insights into the global nature of this problem. It is imperative that we broaden the current narrative around land use and supply, to the need to establish a holistic system that connects housing, infrastructure and place across the spectrum of government and industry.</p>
<p>The content of this work was presented at the third Hunter Insight Series, presented at the University of Newcastle in October 2023.</p>
<section id="summary" class="level2 container">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This presentation outlines the profound housing crisis currently faced by Australia and the critical need for systemic reform. It draws parallels between the Australian situation and international responses to the global housing crisis. By examining historical initiatives, the presentation highlights the continuity of housing challenges throughout the years. The inefficiencies in the existing housing planning and delivery system in New South Wales are exposed, emphasizing the urgent need for transformation. Key issues are 1) the misalignment between projections and targets; 2) the inadequacy of local government areas as housing market areas; and 3) the misconception that rezoning land guarantees supply. We emphasise the importance of adopting a housing market area approach, considering internal migration patterns, and embracing stakeholder engagement for adaptive management. Systemic improvements are urgently required to deliver sustainable solutions and avoid future housing crises.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The housing crisis is a pressing concern that demands immediate attention and systemic reform. There are many challenges faced by the housing sector in Australia, but these have comparative international responses, and a long history. The existing housing planning and delivery system in New South Wales has limitations and needs transformative changes. This presentation addresses key issues, proposes solutions, and stresses the urgency of adopting a housing market area approach.</p>
</section>
<section id="international-experiences" class="level2">
<h2 class="anchored" data-anchor-id="international-experiences">International experiences</h2>
<p>Australia is not alone in facing this housing challenge. Governments across the globe have been taking similarly drastic measures. One such case is Ontario, Canada, where the reactions to their proposed solutions closely mirrored the discourse here in Australia. The enormity of the changes being proposed, both here and abroad, have been genuinely unprecedented.</p>
<p><img src="slides_housing/slide2.png" class="img-fluid"></p>
</section>
<section id="history-repeating" class="level2">
<h2 class="anchored" data-anchor-id="history-repeating">History repeating</h2>
<p>The housing crisis is not a recent phenomenon; it has deep historical roots. The Australian Housing Conference in 1982 serves as a case in point. A pamphlet from the conference illustrates the longevity of the crisis with a number of familiar and recurring themes raised, including:</p>
<ul>
<li><p>a large backlog of neglected housing needs,</p></li>
<li><p>growing homelessness and reliance on marginal forms of housing,</p></li>
<li><p>rising interest rates excluding people from home ownership,</p></li>
<li><p>overcrowded private rental markets, and</p></li>
<li><p>long waitlists for public housing.”</p></li>
</ul>
<p><img src="slides_housing/slide3.png" class="img-fluid"></p>
</section>
<section id="where-to-start" class="level2">
<h2 class="anchored" data-anchor-id="where-to-start">Where to start?</h2>
<p>More Government money than ever has been allocated to deliver housing…land dedications, faster approvals, infrastructure, construction skills and capacity building have been prioritised. However, before we pour billions of dollars into the system and hope for better outcomes, it’s worth pausing for a minute to check whether the system we’re all working away tirelessly within is setting us up for success.</p>
<p><img src="slides_housing/slide4.png" class="img-fluid"></p>
</section>
<section id="nsw-planning-framework" class="level2">
<h2 class="anchored" data-anchor-id="nsw-planning-framework">NSW Planning Framework</h2>
<p>In practice the ‘heart beat’ of the NSW Population projections are circulated through the system by a range of policy directives. The ‘main artery’ for planning goes via Regional Plans to Local Strategic Planning Statements to be operationalised. One of the hallmark characteristics of the system in NSW is how long it takes an idea to translate into changes on the ground – which can be anything from 5 to 15 years (or more). That’s because this system is linear, complex, and relies on several interdependencies. We must ask ourselves whether this sets us up for the rapid responses to the housing crises that we urgently need?</p>
<p><img src="slides_housing/slide5.png" class="img-fluid"></p>
</section>
<section id="key-truths" class="level2">
<h2 class="anchored" data-anchor-id="key-truths">Key Truths</h2>
<p>Three fundamental truths must be acknowledged for effective planning:</p>
<ul>
<li><p><strong>Projections Are Not Targets:</strong> Population projections, while vital, fluctuate over time, demanding a flexible approach to housing planning.</p></li>
<li><p><strong>Local Government Areas Are Not Housing Market Areas:</strong> To understand the housing market’s needs, it is imperative to define housing market areas that transcend local government boundaries.</p></li>
<li><p><strong>Rezoning Does Not Guarantee Supply:</strong> Rezoning land is only one part of the solution; adequate infrastructure and systemic support are equally crucial.</p></li>
</ul>
<p><img src="slides_housing/slide6.png" class="img-fluid"></p>
</section>
<section id="projections-arent-targets" class="level2">
<h2 class="anchored" data-anchor-id="projections-arent-targets">Projections aren’t targets</h2>
<p>One of the key drivers of housing demand is population growth so it makes sense that the State-wide population projections, published by the NSW government, are in the planners’ toolkit. As part of the ‘Common Planning Assumptions’, the projections are required to inform state agencies’ service and asset planning, and Councils’ local strategies.</p>
<p>But how do these projections perform over time? The Hunter Research Foundation Centre dataset includes historic Government projections. This slide below uses those to show how the ‘growth story’ we tell ourselves about the region has changed in less than a decade. The hatched columns are the projected population levels, as updated every 3 years since 2016. Where we thought we’d grow to by 2036 back in 2019 (shown in yellow) was 63,000 people less than what was last projected in 2022 (shown in red). The solid blue tracks how the Hunter’s population has actually grown according to census data since 2006. The trendline shows how close we’re tracking against what was projected based on past performance. This indicates that it is entirely possible that we could achieve higher growth levels than have previously been projected.</p>
<p><img src="slides_housing/slide8.png" class="img-fluid"></p>
</section>
<section id="nsw-implied-dwellings" class="level2">
<h2 class="anchored" data-anchor-id="nsw-implied-dwellings">NSW Implied dwellings</h2>
<p>Understanding how many houses we need to accommodate that growth is not easy algebra. But this is given to us in the number of ‘implied dwellings’ published alongside the population projections.</p>
<p>The dwellings projections are based on top down assumptions like household formation and bottom up assumptions like how much housing the existing zoned land can deliver.</p>
<p>This next slide singles out Newcastle and Lake Macquarie – the two largest local government areas in the Hunter by population. Like the slide before, it shows how much the projected dwellings have changed since 2016 –by around 5,000 houses in Lake Macquarie. The same data for Maitland would show a difference of around 12,000 houses. This is a fast-moving target to try and operationalise in a linear, complex, interdependent system!</p>
<p>Unlike the population slide before, the actual versus projected dwellings trends indicate we could fall short of the number of houses we expect to require. If that is indeed a shortfall, it compounds every year, but that growing historic deficit isn’t picked up as additional need anywhere in our planning system – the updated projections each year keep us looking forward to future need, not historic needs. So, our ‘in practice’ target is never giving us the full picture.</p>
<p><img src="slides_housing/slide9.png" class="img-fluid"></p>
<p>The next three slides help illustrate what that oversight means in the Hunter’s ‘lived experience’.</p>
</section>
<section id="rental-vacancy" class="level2">
<h2 class="anchored" data-anchor-id="rental-vacancy">Rental Vacancy</h2>
<p>Here we have SQM data showing rental vacancy rates going back to 2010. Typically, a 3% benchmark is used to indicate a healthy market – one where tenants and landlords can have fair negotiations about things like rent and living conditions. The data shows that while the Hunter reached up an almost touched that 3% benchmark in mid-2015, the reality is that our region has an entire generation of people who have never experienced what it is like to live in a fair and accessible housing market.</p>
<p><img src="slides_housing/slide10.png" class="img-fluid"></p>
</section>
<section id="homelessness" class="level2">
<h2 class="anchored" data-anchor-id="homelessness">Homelessness</h2>
<p>The next slide shows the rise in homelessness for our Region over the last 20 years. The chart is normalised to the 2001 levels for the Hunter, NSW, and Australia. It shows our Region’s rate of homelessness has almost doubled in the last 20 years. And, while the national and state levels reduced in the last census period, our homelessness rates continued to grow.</p>
<p><img src="slides_housing/slide11.png" class="img-fluid"></p>
</section>
<section id="overcrowding" class="level2">
<h2 class="anchored" data-anchor-id="overcrowding">Overcrowding</h2>
<p>Hidden forms of homelessness are also on the rise, which looks like: crisis accommodation, people living temporarily in boarding houses or caravan parks, or staying periodically between various friends’ houses.</p>
<p>Here in the Hunter, we have a rising problem of overcrowding.</p>
<p>Typically, we would expect to find overcrowding is more common in certain segments of the population – including migrant families, students, and First Nations households. Some of this is culturally driven, but much of it is not particularly where it’s prolonged or identified as ‘severe’, which is defined in the census as – households that would need 4 or more additional bedrooms to meet their needs.</p>
<p>This next slide shows the spatial inequalities emerging across the Region, with Newcastle, Lake Macquarie, MidCoast, and Cessnock showing the highest concentrations.</p>
<p><img src="slides_housing/slide12.png" class="img-fluid"></p>
<p><strong>We urgently need to move beyond relying on projections as our ‘in practice’ housing target and instead develop more robust planning methodologies with a built-in level of contingency to truly address pre-existing and future housing needs.</strong></p>
</section>
<section id="local-government-areas-are-not-housing-markets" class="level2">
<h2 class="anchored" data-anchor-id="local-government-areas-are-not-housing-markets">Local Government Areas are not housing markets</h2>
<p>An awful lot of expectation and responsibility to deal with the housing crises falls to Councils – they’re involved in setting the planning controls, assessing and approving residential developments, and delivering local infrastructure and services.</p>
<p>But allocating a portion of growth to a local government area doesn’t give us the full picture of what ‘the market’ needs, because local government areas are not housing markets.</p>
</section>
<section id="scottish-planning-model" class="level2">
<h2 class="anchored" data-anchor-id="scottish-planning-model">Scottish Planning Model</h2>
<p>If we’re going to think about whether our system is designed for success, it is worth looking at other approaches. Given the almost global experience of a housing crisis, we can’t point to anywhere as ‘best practice’. But if we’re going to rely on localised approaches, we can look at systems like Scotland’s for lessons.</p>
<p>Key to this approach is…that it starts by defining <strong>local housing market areas</strong>, to set the frame for strategic planning and policy setting. From there, it mandates a governance arrangement to determine needs and agree targets, before operationalising these through policy or planning controls.</p>
<p>Defining a market for a good is about understanding where a level of price uniformity exists in the context of transport cost. The difference being that in ‘goods’ markets, it is the product is that moves… but in a housing market, it’s the people that move.</p>
<p>So, here at the Institute, we’ve been playing around for the last several weeks to draw on examples from literature and practice, including guidelines from the UK and housing studies by SGS here in Australia to try and re-imagine a different spatial framework that might help us understand housing market needs more robustly.</p>
<p><img src="slides_housing/slide14.png" class="img-fluid"></p>
</section>
<section id="case-for-housing-market-areas" class="level2">
<h2 class="anchored" data-anchor-id="case-for-housing-market-areas">Case for housing market areas</h2>
<p>We rely so heavily on journey-to-work data in planning, but it is evident across Australia that centres-based planning is become less relevant due to the decentralisation of jobs and rise of more ‘From home’ options to access goods and services (think home schooling, Amazon delivery, and Uber Eats).</p>
<p>Looking at buyer/renter behaviour we know that people aren’t necessarily tethered to the address of their employer. It’s a complex and often highly personalised choice model …just think about your own motivations the last time you moved – was it:</p>
<ol type="1">
<li>To get into your preferred school catchment?</li>
<li>To be closer to your parents?</li>
<li>To get closer to the beach?</li>
</ol>
<p>And here in the Hunter, many households have traditionally opted to locate themselves between more than one centre to meet their specific needs – for example much of Maitland’s growth has been attributed to dual-income households with one person working in mining in the Upper Hunter and the other in health or education in the Lower Hunter.</p>
<p>So rather than journey to work, we drew from internal migration patterns using data from the last two census periods. That allows this map to tell us where people who are already local and need to change their house (but not uproot their whole lives) are more likely to search to meet their need.</p>
<p>This approach is different from the journey to work approach because it is likely to reflect more of the social, price-tag, and place-attachment drivers influencing people’s decisions about where to live.</p>
<p>The different colours show these migration-based ‘housing market areas’, and the white lines are local government area boundaries. This modelling showed time and again that in reality, people’s choice about where to live doesn’t stop at LGA boundaries.</p>
<p><img src="slides_housing/slide15.png" class="img-fluid"></p>
<p>The place-based solutions we urgently need to address the housing crises must be grounded in action, not just aspiration. Taking a housing market rather than LGA approach do this would make more sense by allowing:</p>
<ol type="1">
<li>Data to be collected and analysed at a level where the trends make sense in relation to the research questions you want to ask,</li>
<li>Governance to happen at an appropriate scale, and</li>
<li>Solutions (be they policy or planning) to be suitably contextualised.</li>
</ol>
<p>This configuration still needs some testing (and some more modelling in the MidCoast area), but we can already see a few advantages to the approach.</p>
<p>Just picking up on Maitland in brown – mover behaviour shows a preference area reaching into both the Newcastle and Port Stephens local government areas and, I would hypothesise, the southern parts of Dungog around Clarence Town if we went more granular than the underlying SA2s we used as building blocks allowed.</p>
<p>We believe using these areas to frame housing needs assessments and governance arrangements would be far more effective than our current approach but putting this approach into practice, however, would require government funding and attention.</p>
<p>I would argue this type of systems-based improvement is just as urgent a priority as addressing our infrastructure backlog if we truly want to deliver sustainable solutions.</p>
</section>
<section id="actual-v-projected-dwellings-again" class="level2">
<h2 class="anchored" data-anchor-id="actual-v-projected-dwellings-again">Actual v Projected dwellings (again)</h2>
<p>Why aren’t we able to supply in line with market demands?</p>
<p>Of course there is a problem with delivering the infrastructure new projects need – There has been a lot of media coverage recently on the cost of infrastructure to service new growth fronts, particularly in Western Sydney and the outer edges of Melbourne.</p>
<p>But this has been a Hunter-specific problem for decades. Misalignment in the funding and delivery of infrastructure – for a long period of time the issue was with Hunter Water’s trunk infrastructure, and more recently the literal roadblock is proving to be Transport for NSW.</p>
<p>Learning from that example, it was the organisational re-think that occurred within Hunter Water that made the difference in so far as they accepted their role in the Region’s growth story and repositioned their own strategic planning capacity and capabilities to do things differently. This is a lesson for all Government agencies responsible for assets that enable new housing projects to go ahead.</p>
<p>But, beyond infrastructure, there is a bigger, more systemic failure which is that we aren’t planning in the right way to truly deliver place-based solutions. We don’t even know the full picture of what we need to operationalise.</p>
<p><img src="slides_housing/slide17.png" class="img-fluid"></p>
<p>So, does it make sense to push billions of dollars of public sector money through this system and expect to achieve the results we need?</p>
</section>
<section id="where-to-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-to-from-here">Where to from here?</h2>
<ul>
<li><p>Taking the time to work on the system now, and pivot into a more <strong>stakeholder engaged adaptive management approach,</strong> will better set us up for success moving forward.</p></li>
<li><p>So, as we embark on an unprecedented level of spending to deliver the housing Australia needs, we call on Governments at all levels to use at least some of that on system improvements now to avoid standing here in another 40 years, recalling the 1982 Australian Housing Conference’s harrowing scope to current crisis in the housing sector.</p></li>
</ul>
<p><img src="slides_housing/slide19.png" class="img-fluid"></p>
<hr>
<p>Delivered by the Institute for Regional Futures, the free <em>Hunter Insight</em> series provides data and analysis compiled by the Institute’s research team addressing social, economic and spatial challenges facing key sectors. The Institute partners with all levels of government, and with industries and communities to build the evidence-base needed for sustainable planning and delivery for regional communities. For more information about the Institute and the <em>Hunter Insight</em> series, please visit <a href="https://www.newcastle.edu.au/research/centre/regional-futures" class="uri">https://www.newcastle.edu.au/research/centre/regional-futures</a></p>
</section>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>